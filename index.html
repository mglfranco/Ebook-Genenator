<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BookBot ‚Äî Gerador de E-books com IA</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box
        }

        :root {
            --bg: #06060f;
            --bg2: #0b0b1a;
            --bg3: #101025;
            --s1: rgba(255, 255, 255, 0.03);
            --s2: rgba(255, 255, 255, 0.055);
            --s3: rgba(255, 255, 255, 0.09);
            --accent: #7c3aed;
            --accent2: #a78bfa;
            --accent3: #c4b5fd;
            --glow: rgba(124, 58, 237, 0.25);
            --glow2: rgba(124, 58, 237, 0.12);
            --green: #10b981;
            --gg: rgba(16, 185, 129, 0.2);
            --pink: #ec4899;
            --cyan: #22d3ee;
            --amber: #f59e0b;
            --red: #ef4444;
            --t: #f0f0f8;
            --t2: #a0a0b8;
            --t3: #6a6a82;
            --b: rgba(255, 255, 255, 0.06);
            --b2: rgba(255, 255, 255, 0.1);
            --r: 14px;
            --r2: 18px;
            --r3: 24px;
        }

        html {
            font-size: 17px;
            scroll-behavior: smooth
        }

        body {
            font-family: 'Inter', system-ui, sans-serif;
            background: var(--bg);
            color: var(--t);
            height: 100vh;
            height: 100dvh;
            /* Mobile viewport fix */
            max-height: 100vh;
            overflow: hidden;
            display: flex
        }

        /* ====== ANIMATED BACKGROUND ====== */
        .bg-layer {
            position: fixed;
            inset: 0;
            z-index: 0;
            overflow: hidden;
            pointer-events: none
        }

        .orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            opacity: .35;
            will-change: transform
        }

        .orb-1 {
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, #7c3aed, transparent);
            top: -10%;
            left: -5%;
            animation: orbA 25s ease-in-out infinite
        }

        .orb-2 {
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, #ec4899, transparent);
            bottom: -15%;
            right: -10%;
            animation: orbB 30s ease-in-out infinite
        }

        .orb-3 {
            width: 350px;
            height: 350px;
            background: radial-gradient(circle, #22d3ee, transparent);
            top: 40%;
            left: 50%;
            animation: orbC 22s ease-in-out infinite;
            opacity: .2
        }

        .orb-4 {
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, #f59e0b, transparent);
            top: 70%;
            left: 20%;
            animation: orbD 28s ease-in-out infinite;
            opacity: .15
        }

        @keyframes orbA {
            0% {
                transform: translate(0, 0) scale(1)
            }

            25% {
                transform: translate(80px, -60px) scale(1.1)
            }

            50% {
                transform: translate(-40px, 80px) scale(.9)
            }

            75% {
                transform: translate(60px, 30px) scale(1.05)
            }

            100% {
                transform: translate(0, 0) scale(1)
            }
        }

        @keyframes orbB {
            0% {
                transform: translate(0, 0) scale(1)
            }

            33% {
                transform: translate(-70px, 50px) scale(1.15)
            }

            66% {
                transform: translate(50px, -70px) scale(.85)
            }

            100% {
                transform: translate(0, 0) scale(1)
            }
        }

        @keyframes orbC {
            0% {
                transform: translate(0, 0)
            }

            50% {
                transform: translate(-60px, 40px) rotate(20deg)
            }

            100% {
                transform: translate(0, 0)
            }
        }

        @keyframes orbD {
            0% {
                transform: translate(0, 0)
            }

            50% {
                transform: translate(40px, -50px)
            }

            100% {
                transform: translate(0, 0)
            }
        }

        .grid-overlay {
            position: fixed;
            inset: 0;
            z-index: 0;
            pointer-events: none;
            background-image: linear-gradient(rgba(255, 255, 255, .012) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, .012) 1px, transparent 1px);
            background-size: 50px 50px
        }

        #particles {
            position: fixed;
            inset: 0;
            z-index: 0;
            pointer-events: none
        }

        /* ====== SCROLLBAR GLOBAL ====== */
        ::-webkit-scrollbar {
            width: 5px;
            height: 5px
        }

        ::-webkit-scrollbar-track {
            background: transparent
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(124, 58, 237, .3);
            border-radius: 5px
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(124, 58, 237, .5)
        }

        * {
            scrollbar-width: thin;
            scrollbar-color: rgba(124, 58, 237, .3) transparent
        }

        /* ====== SIDEBAR ====== */
        .sidebar {
            width: 300px;
            min-height: 100vh;
            max-height: 100vh;
            background: rgba(11, 11, 26, .97);
            backdrop-filter: blur(20px);
            border-right: 1px solid var(--b);
            display: flex;
            flex-direction: column;
            z-index: 2;
            overflow-y: auto;
            flex-shrink: 0
        }

        .sb {
            padding: 1.2rem 1rem;
            display: flex;
            flex-direction: column;
            min-height: 100%;
            position: relative;
        }

        .sb-close {
            display: none;
        }

        /* Logo */
        .logo {
            display: flex;
            align-items: center;
            gap: .55rem;
            margin-bottom: 1.2rem;
            padding: 0 .15rem
        }

        .logo__ic {
            width: 44px;
            height: 44px;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--accent), var(--pink));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.35rem;
            box-shadow: 0 4px 20px var(--glow);
            position: relative;
            overflow: hidden
        }

        .logo__ic::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, transparent 40%, rgba(255, 255, 255, .2) 50%, transparent 60%);
            animation: shimmer 3s infinite
        }

        @keyframes shimmer {
            0% {
                transform: translateX(-100%)
            }

            100% {
                transform: translateX(100%)
            }
        }

        .logo__t {
            font-weight: 800;
            font-size: 1.2rem;
            letter-spacing: -.02em
        }

        .logo__v {
            font-size: .7rem;
            color: var(--t3);
            font-weight: 500;
            letter-spacing: .05em
        }

        .div {
            height: 1px;
            background: var(--b);
            margin: .7rem 0
        }

        .lbl {
            font-size: .7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: .18em;
            color: var(--t3);
            margin-bottom: .5rem;
            padding: 0 .2rem;
            display: flex;
            align-items: center;
            gap: .4rem
        }

        .lbl i {
            font-style: normal;
            font-size: .8rem
        }

        /* Option cards */
        .og {
            display: flex;
            flex-direction: column;
            gap: .2rem;
            margin-bottom: .15rem
        }

        .oc {
            padding: .5rem .65rem;
            border-radius: 10px;
            cursor: pointer;
            border: 1px solid transparent;
            transition: all .2s;
            display: flex;
            align-items: center;
            gap: .5rem;
            font-size: .88rem;
            font-weight: 500;
            color: var(--t2)
        }

        .oc:hover {
            background: var(--s2);
            border-color: var(--b)
        }

        .oc.on {
            background: var(--glow2);
            border-color: rgba(124, 58, 237, .3);
            color: var(--accent2)
        }

        .oc__d {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            flex-shrink: 0
        }

        .oc__ck {
            margin-left: auto;
            font-size: .75rem;
            opacity: 0;
            transition: opacity .2s
        }

        .oc.on .oc__ck {
            opacity: 1
        }

        /* Select */
        .sel {
            width: 100%;
            padding: .55rem .7rem;
            background: var(--s1);
            border: 1px solid var(--b);
            border-radius: 10px;
            color: var(--t);
            font-family: inherit;
            font-size: .88rem;
            outline: none;
            cursor: pointer;
            appearance: none;
            transition: all .2s;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='10' fill='%236a6a82' viewBox='0 0 16 16'%3E%3Cpath d='M8 12L2 6h12z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right .6rem center;
            padding-right: 2rem
        }

        .sel:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 2px var(--glow)
        }

        .sel option {
            background: #1a1a2e;
            color: var(--t)
        }

        .sf {
            margin-bottom: .5rem
        }

        /* Project Templates */
        .tpl-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: .25rem;
            margin-bottom: .1rem
        }

        .tpl {
            padding: .5rem .4rem;
            border-radius: 10px;
            cursor: pointer;
            text-align: center;
            background: var(--s1);
            border: 1px solid var(--b);
            transition: all .25s;
            font-size: .78rem;
            font-weight: 500;
            color: var(--t2);
            line-height: 1.3
        }

        .tpl:hover {
            background: var(--glow2);
            border-color: rgba(124, 58, 237, .3);
            color: var(--accent2);
            transform: translateY(-1px)
        }

        .tpl i {
            display: block;
            font-style: normal;
            font-size: 1.3rem;
            margin-bottom: .2rem
        }

        /* Library */
        .lib {
            display: flex;
            flex-direction: column;
            gap: .2rem;
            max-height: 130px;
            overflow-y: auto
        }

        .lib-item {
            padding: .35rem .5rem;
            border-radius: 9px;
            background: var(--s1);
            border: 1px solid var(--b);
            cursor: pointer;
            transition: all .2s
        }

        .lib-item:hover {
            background: var(--s2);
            border-color: var(--b2)
        }

        .lib-item__t {
            font-size: .85rem;
            font-weight: 600;
            color: var(--t);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis
        }

        .lib-item__m {
            font-size: .72rem;
            color: var(--t3);
            margin-top: .1rem;
            display: flex;
            gap: .5rem
        }

        .lib-empty {
            font-size: .68rem;
            color: var(--t3);
            font-style: italic;
            padding: .2rem
        }

        /* Stats */
        .sg {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: .25rem
        }

        .sc {
            background: var(--s1);
            border: 1px solid var(--b);
            border-radius: 9px;
            padding: .35rem;
            text-align: center
        }

        .sc__n {
            font-size: 1.3rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent2), var(--pink));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text
        }

        .sc__l {
            font-size: .65rem;
            color: var(--t3);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: .1em;
            margin-top: .1rem
        }

        .sb-ft {
            margin-top: auto;
            padding-top: .5rem
        }

        .sb-fc {
            background: var(--s1);
            border: 1px solid var(--b);
            border-radius: 10px;
            padding: .6rem;
            font-size: .75rem;
            color: var(--t3);
            line-height: 1.5;
            text-align: center
        }

        .sb-fc b {
            color: var(--accent2)
        }

        /* ====== MAIN ====== */
        .main {
            flex: 1;
            display: flex;
            flex-direction: column;
            position: relative;
            z-index: 1;
            min-width: 0;
            min-height: 0;
            /* Flexbox scroll fix */
            max-height: 100vh;
        }

        /* Topbar */
        .top {
            height: 56px;
            border-bottom: 1px solid var(--b);
            display: flex;
            align-items: center;
            padding: 0 1.5rem;
            background: rgba(6, 6, 15, .85);
            backdrop-filter: blur(24px);
            gap: .7rem;
            flex-shrink: 0
        }

        .top__st {
            display: flex;
            align-items: center;
            gap: .4rem;
            font-size: .85rem;
            color: var(--green);
            font-weight: 600
        }

        .top__dot {
            width: 7px;
            height: 7px;
            border-radius: 50%;
            background: var(--green);
            box-shadow: 0 0 8px var(--gg);
            animation: pulse 2s infinite
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1
            }

            50% {
                opacity: .4
            }
        }

        .top__sep {
            width: 1px;
            height: 16px;
            background: var(--b);
            margin: 0 .2rem
        }

        .top__mdl {
            font-size: .78rem;
            color: var(--t3)
        }

        .top__r {
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: .4rem
        }

        .top__btn {
            background: var(--s2);
            border: 1px solid var(--b);
            border-radius: 8px;
            padding: .4rem .7rem;
            font-size: .8rem;
            color: var(--t2);
            cursor: pointer;
            font-family: inherit;
            transition: all .2s;
            display: flex;
            align-items: center;
            gap: .3rem
        }

        .top__btn:hover {
            background: var(--glow2);
            border-color: rgba(124, 58, 237, .3);
            color: var(--accent2)
        }

        /* Chat */
        .chat {
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            padding: 1.5rem 2rem;
            display: flex;
            flex-direction: column;
            gap: 1rem
        }

        /* Messages */
        .msg {
            display: flex;
            gap: .5rem;
            max-width: 82%;
            animation: msgIn .4s cubic-bezier(.22, 1, .36, 1)
        }

        .msg--u {
            align-self: flex-end;
            flex-direction: row-reverse
        }

        .msg--b {
            align-self: flex-start
        }

        @keyframes msgIn {
            from {
                opacity: 0;
                transform: translateY(12px) scale(.97)
            }

            to {
                opacity: 1;
                transform: none
            }
        }

        .msg__a {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem
        }

        .msg--b .msg__a {
            background: linear-gradient(135deg, var(--accent), var(--pink));
            box-shadow: 0 2px 8px var(--glow)
        }

        .msg--u .msg__a {
            background: var(--s3)
        }

        .msg__bb {
            padding: .75rem 1.1rem;
            border-radius: var(--r2);
            line-height: 1.65;
            font-size: 1rem
        }

        .msg--b .msg__bb {
            background: var(--s2);
            border: 1px solid var(--b);
            border-bottom-left-radius: 4px
        }

        .msg--u .msg__bb {
            background: linear-gradient(135deg, var(--accent), #6d28d9);
            border-bottom-right-radius: 4px;
            color: #fff
        }

        .msg__bb p {
            margin-bottom: .3rem
        }

        .msg__bb p:last-child {
            margin-bottom: 0
        }

        .msg__bb strong {
            color: var(--accent3)
        }

        .msg--u .msg__bb strong {
            color: #fff
        }

        .msg__bb ul,
        .msg__bb ol {
            margin: .2rem 0 .2rem 1rem
        }

        .msg__bb li {
            margin-bottom: .08rem
        }

        .msg__bb code {
            background: rgba(124, 58, 237, .15);
            padding: .04rem .2rem;
            border-radius: 3px;
            font-size: .76rem
        }

        .msg__ex {
            margin-top: .35rem
        }

        /* Typing */
        .typ {
            display: flex;
            gap: .15rem;
            padding: .3rem;
            align-items: center
        }

        .typ i {
            width: 5px;
            height: 5px;
            border-radius: 50%;
            background: var(--t3);
            animation: tBounce 1.4s infinite;
            font-style: normal
        }

        .typ i:nth-child(2) {
            animation-delay: .2s
        }

        .typ i:nth-child(3) {
            animation-delay: .4s
        }

        @keyframes tBounce {

            0%,
            60%,
            100% {
                transform: translateY(0)
            }

            30% {
                transform: translateY(-5px)
            }
        }

        .sugs {
            display: flex;
            flex-wrap: wrap;
            gap: .5rem;
            padding: .6rem 2rem .3rem;
            flex-shrink: 0
        }

        .sug {
            padding: .5rem .9rem;
            border-radius: 20px;
            font-size: .88rem;
            font-weight: 500;
            background: var(--s1);
            border: 1px solid var(--b2);
            color: var(--t2);
            cursor: pointer;
            transition: all .25s;
            white-space: nowrap
        }

        .sug:hover {
            background: var(--glow2);
            border-color: rgba(124, 58, 237, .3);
            color: var(--accent2);
            transform: translateY(-1px)
        }

        .inp-area {
            padding: .8rem 2rem 1rem;
            border-top: 1px solid var(--b);
            background: rgba(6, 6, 15, .7);
            backdrop-filter: blur(24px);
            flex-shrink: 0
        }

        .inp-w {
            display: flex;
            align-items: center;
            gap: .5rem;
            background: var(--s2);
            border: 1px solid var(--b2);
            border-radius: var(--r2);
            padding: .25rem .25rem .25rem .9rem;
            transition: all .25s
        }

        .inp-w:focus-within {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px var(--glow)
        }

        .inp-w input {
            flex: 1;
            background: transparent;
            border: none;
            outline: none;
            color: var(--t);
            font-family: inherit;
            font-size: 1rem;
            min-width: 0;
            padding: .3rem 0
        }

        .inp-w input::placeholder {
            color: var(--t3)
        }

        .snd {
            width: 42px;
            height: 42px;
            border-radius: 12px;
            border: none;
            cursor: pointer;
            background: linear-gradient(135deg, var(--accent), #6d28d9);
            color: #fff;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all .25s;
            flex-shrink: 0
        }

        .snd:hover {
            transform: scale(1.06);
            box-shadow: 0 4px 12px var(--glow)
        }

        .snd:disabled {
            opacity: .3;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important
        }

        /* Timeline */
        .tl {
            padding: .6rem .9rem;
            background: var(--s1);
            border: 1px solid var(--b);
            border-radius: var(--r);
            margin-top: .4rem
        }

        .tl-s {
            display: flex;
            align-items: center;
            gap: .45rem;
            padding: .3rem 0;
            font-size: .88rem;
            color: var(--t3);
            transition: color .3s
        }

        .tl-s.on {
            color: var(--accent2)
        }

        .tl-s.ok {
            color: var(--green)
        }

        .tl-i {
            width: 18px;
            text-align: center;
            font-size: .85rem
        }

        .tl-s.on .tl-i {
            animation: spin 1s linear infinite
        }

        @keyframes spin {
            to {
                transform: rotate(360deg)
            }
        }

        .dl {
            background: linear-gradient(135deg, rgba(16, 185, 129, .06), rgba(124, 58, 237, .06));
            border: 1px solid rgba(16, 185, 129, .2);
            border-radius: var(--r2);
            padding: 1rem;
            margin-top: .4rem;
            text-align: center
        }

        .dl__t {
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--green);
            margin-bottom: .3rem
        }

        .dl__s {
            font-size: .82rem;
            color: var(--t3);
            margin-bottom: .5rem
        }

        .dl__b {
            display: inline-flex;
            align-items: center;
            gap: .35rem;
            padding: .55rem 1.1rem;
            border-radius: 12px;
            border: none;
            background: var(--green);
            color: #06060f;
            font-family: inherit;
            font-weight: 700;
            font-size: .92rem;
            cursor: pointer;
            transition: all .25s;
            text-decoration: none;
            margin: .2rem
        }

        .dl__b:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px var(--gg)
        }

        .dl__b--preview {
            background: var(--accent);
            color: #fff
        }

        .dl__b--preview:hover {
            box-shadow: 0 4px 15px var(--glow)
        }

        /* PDF Preview Modal */
        .pdf-modal {
            display: none;
            position: fixed;
            inset: 0;
            z-index: 100;
            background: rgba(0, 0, 0, .8);
            backdrop-filter: blur(8px);
            align-items: center;
            justify-content: center;
            padding: 1.5rem
        }

        .pdf-modal.show {
            display: flex
        }

        .pdf-viewer {
            background: var(--bg2);
            border: 1px solid var(--b2);
            border-radius: var(--r2);
            width: 100%;
            max-width: 850px;
            height: 85vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, .5)
        }

        .pdf-viewer__top {
            display: flex;
            align-items: center;
            padding: .6rem 1rem;
            border-bottom: 1px solid var(--b);
            gap: .5rem;
            flex-shrink: 0
        }

        .pdf-viewer__title {
            font-weight: 700;
            font-size: 1rem;
            flex: 1
        }

        .pdf-viewer__btn {
            background: var(--s2);
            border: 1px solid var(--b);
            border-radius: 8px;
            padding: .45rem .8rem;
            font-size: .88rem;
            color: var(--t2);
            cursor: pointer;
            font-family: inherit;
            transition: all .2s;
            display: flex;
            align-items: center;
            gap: .3rem
        }

        .pdf-viewer__btn:hover {
            background: var(--glow2);
            border-color: rgba(124, 58, 237, .3);
            color: var(--accent2)
        }

        .pdf-viewer__btn--green {
            background: var(--green);
            color: #06060f;
            border-color: var(--green);
            font-weight: 700
        }

        .pdf-viewer__close {
            background: var(--s2);
            border: 1px solid var(--b);
            border-radius: 8px;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: .85rem;
            color: var(--t2);
            transition: all .2s
        }

        .pdf-viewer__close:hover {
            background: rgba(239, 68, 68, .15);
            border-color: var(--red);
            color: var(--red)
        }

        .pdf-viewer__frame {
            flex: 1;
            border: none;
            width: 100%
        }

        /* Welcome */
        .welcome {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1.5rem;
            text-align: center
        }

        .welcome__ic {
            font-size: 3.8rem;
            margin-bottom: 1rem;
            animation: float 3s ease-in-out infinite;
            filter: drop-shadow(0 0 15px var(--glow))
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0)
            }

            50% {
                transform: translateY(-8px)
            }
        }

        .welcome__t {
            font-size: 1.8rem;
            font-weight: 900;
            letter-spacing: -.04em;
            background: linear-gradient(135deg, #fff 20%, var(--accent2) 50%, var(--pink) 80%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: .35rem;
            animation: gShift 6s ease infinite;
            background-size: 200% 200%
        }

        @keyframes gShift {
            0% {
                background-position: 0% 50%
            }

            50% {
                background-position: 100% 50%
            }

            100% {
                background-position: 0% 50%
            }
        }

        .welcome__sub {
            color: var(--t3);
            font-size: .82rem;
            line-height: 1.5;
            max-width: 400px
        }

        .welcome__feats {
            display: flex;
            flex-wrap: wrap;
            gap: .4rem;
            margin-top: 1rem;
            justify-content: center
        }

        .welcome__f {
            display: flex;
            align-items: center;
            gap: .25rem;
            padding: .28rem .55rem;
            background: var(--s1);
            border: 1px solid var(--b);
            border-radius: 20px;
            font-size: .62rem;
            color: var(--t2)
        }

        /* Responsive */
        .sb-toggle {
            display: none;
            position: fixed;
            top: .6rem;
            left: .6rem;
            z-index: 10;
            width: 36px;
            height: 36px;
            border-radius: 10px;
            background: var(--s2);
            border: 1px solid var(--b);
            color: var(--t);
            cursor: pointer;
            font-size: 1.1rem;
            display: none;
            align-items: center;
            justify-content: center
        }

        @media(max-width:768px) {
            .sidebar {
                position: fixed;
                left: -300px;
                transition: left .3s ease-in-out;
                z-index: 20;
                height: 100vh;
                box-shadow: 10px 0 30px rgba(0, 0, 0, 0.5);
            }

            .sidebar.open {
                left: 0;
            }

            .sidebar.open~.sb-overlay {
                display: block !important;
            }

            .sb-close {
                display: block;
                position: absolute;
                top: 1rem;
                right: 1rem;
                cursor: pointer;
                font-size: 1.2rem;
                color: var(--t2);
            }

            .sb-toggle {
                display: flex !important
            }

            .top {
                padding-left: 3rem
            }

            .chat {
                padding: .7rem
            }

            .sugs {
                padding: .3rem .7rem
            }

            .inp-area {
                padding: .4rem .7rem .6rem
            }

            .msg {
                max-width: 92%
            }

            .welcome__t {
                font-size: 1.3rem
            }

            .pdf-modal {
                padding: .5rem
            }

            .pdf-viewer {
                height: 90vh;
                border-radius: var(--r)
            }
        }
    </style>
</head>

<body>

    <!-- BG -->
    <div class="bg-layer">
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="orb orb-3"></div>
        <div class="orb orb-4"></div>
    </div>
    <div class="grid-overlay"></div>
    <canvas id="particles"></canvas>

    <!-- Mobile toggle -->
    <button class="sb-toggle" onclick="document.querySelector('.sidebar').classList.toggle('open')">‚ò∞</button>

    <!-- PDF Preview Modal -->
    <div class="pdf-modal" id="pdfModal">
        <div class="pdf-viewer">
            <div class="pdf-viewer__top">
                <span class="pdf-viewer__title" id="pdfTitle">Preview</span>
                <a class="pdf-viewer__btn pdf-viewer__btn--green" id="pdfDlBtn" download>üì• Baixar</a>
                <div class="pdf-viewer__close" onclick="closePdf()">‚úï</div>
            </div>
            <iframe class="pdf-viewer__frame" id="pdfFrame"></iframe>
        </div>
    </div>

    <!-- Mobile overlay -->
    <div class="sb-overlay" onclick="document.querySelector('.sidebar').classList.remove('open')"
        style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.5); z-index:15;"></div>

    <!-- SIDEBAR -->
    <aside class="sidebar">
        <div class="sb">
            <div class="sb-close" onclick="document.querySelector('.sidebar').classList.remove('open')">‚úï</div>
            <div class="logo">
                <div class="logo__ic">üìö</div>
                <div>
                    <div class="logo__t">BookBot</div>
                    <div class="logo__v">AI E-BOOK ENGINE v6</div>
                </div>
            </div>

            <!-- PROJETOS -->
            <div class="div"></div>
            <div class="lbl"><i>üöÄ</i>IN√çCIO R√ÅPIDO</div>
            <div class="tpl-grid">
                <div class="tpl" onclick="sendTpl('Educacional','Quero um e-book educacional completo')">
                    <i>üìö</i>Educacional
                </div>
                <div class="tpl" onclick="sendTpl('Neg√≥cios','Quero um e-book sobre neg√≥cios e empreendedorismo')">
                    <i>üíº</i>Neg√≥cios
                </div>
                <div class="tpl" onclick="sendTpl('Tecnologia','Quero um e-book sobre tecnologia')">
                    <i>üíª</i>Tecnologia
                </div>
                <div class="tpl" onclick="sendTpl('Sa√∫de','Quero um e-book sobre sa√∫de e bem-estar')">
                    <i>üè•</i>Sa√∫de
                </div>
                <div class="tpl"
                    onclick="sendTpl('Desenvolvimento Pessoal','Quero um e-book sobre desenvolvimento pessoal e produtividade')">
                    <i>üß†</i>Pessoal
                </div>
                <div class="tpl" onclick="sendTpl('Fic√ß√£o','Quero criar um e-book de fic√ß√£o/romance')">
                    <i>üìñ</i>Fic√ß√£o
                </div>
                <div class="tpl" onclick="sendTpl('Marketing','Quero um e-book sobre marketing digital')">
                    <i>üì±</i>Marketing
                </div>
                <div class="tpl" onclick="sendTpl('Culin√°ria','Quero um e-book de receitas e gastronomia')">
                    <i>üç≥</i>Culin√°ria
                </div>
            </div>

            <!-- TEMAS -->
            <div class="div"></div>
            <div class="lbl"><i>üé®</i>TEMA PDF</div>
            <div class="og" id="thCards">
                <div class="oc on" data-val="Minimalista Moderno" onclick="pk(this,'theme')">
                    <span class="oc__d"
                        style="background:linear-gradient(135deg,#6c5ce7,#a29bfe)"></span>Minimalista<span
                        class="oc__ck">‚úì</span>
                </div>
                <div class="oc" data-val="Fic√ß√£o Cient√≠fica Neon" onclick="pk(this,'theme')">
                    <span class="oc__d" style="background:linear-gradient(135deg,#00f5d4,#7b2ff7)"></span>Sci-Fi
                    Neon<span class="oc__ck">‚úì</span>
                </div>
                <div class="oc" data-val="Aquarela Cl√°ssica" onclick="pk(this,'theme')">
                    <span class="oc__d" style="background:linear-gradient(135deg,#f093fb,#f5576c)"></span>Aquarela<span
                        class="oc__ck">‚úì</span>
                </div>
                <div class="oc" data-val="Corporativo Elegante" onclick="pk(this,'theme')">
                    <span class="oc__d"
                        style="background:linear-gradient(135deg,#2d3436,#636e72)"></span>Corporativo<span
                        class="oc__ck">‚úì</span>
                </div>
                <div class="oc" data-val="Vintage Retr√¥" onclick="pk(this,'theme')">
                    <span class="oc__d" style="background:linear-gradient(135deg,#c9956b,#8b6914)"></span>Vintage<span
                        class="oc__ck">‚úì</span>
                </div>
                <div class="oc" data-val="Natureza Org√¢nica" onclick="pk(this,'theme')">
                    <span class="oc__d" style="background:linear-gradient(135deg,#11998e,#38ef7d)"></span>Natureza<span
                        class="oc__ck">‚úì</span>
                </div>
            </div>

            <!-- ESTILO -->
            <div class="div"></div>
            <div class="lbl"><i>üé≠</i>ESTILO DE ESCRITA</div>
            <div class="og" id="stCards">
                <div class="oc on" data-val="Profissional" onclick="pk(this,'style')">
                    <span class="oc__d" style="background:var(--accent)"></span>Profissional<span
                        class="oc__ck">‚úì</span>
                </div>
                <div class="oc" data-val="Acad√™mico" onclick="pk(this,'style')">
                    <span class="oc__d" style="background:var(--cyan)"></span>Acad√™mico<span class="oc__ck">‚úì</span>
                </div>
                <div class="oc" data-val="Narrativo" onclick="pk(this,'style')">
                    <span class="oc__d" style="background:var(--pink)"></span>Narrativo<span class="oc__ck">‚úì</span>
                </div>
                <div class="oc" data-val="T√©cnico" onclick="pk(this,'style')">
                    <span class="oc__d" style="background:var(--green)"></span>T√©cnico<span class="oc__ck">‚úì</span>
                </div>
                <div class="oc" data-val="Motivacional" onclick="pk(this,'style')">
                    <span class="oc__d" style="background:var(--amber)"></span>Motivacional<span class="oc__ck">‚úì</span>
                </div>
            </div>

            <!-- P√öBLICO -->
            <div class="div"></div>
            <div class="lbl"><i>üéØ</i>P√öBLICO-ALVO</div>
            <div class="sf"><select class="sel" id="aud" onchange="S.audience=this.value">
                    <option value="P√∫blico geral">üåê P√∫blico Geral</option>
                    <option value="Iniciante">üå± Iniciante</option>
                    <option value="Intermedi√°rio">üìà Intermedi√°rio</option>
                    <option value="Avan√ßado / Expert">üß† Expert</option>
                    <option value="Crian√ßas (8-12 anos)">üëß Crian√ßas</option>
                    <option value="Universit√°rios">üéì Universit√°rios</option>
                    <option value="Executivos">üíº Executivos</option>
                </select></div>

            <!-- IDIOMA -->
            <div class="div"></div>
            <div class="lbl"><i>üåç</i>IDIOMA</div>
            <div class="sf"><select class="sel" id="lang" onchange="S.language=this.value">
                    <option value="Portugu√™s Brasileiro">üáßüá∑ Portugu√™s</option>
                    <option value="English">üá∫üá∏ English</option>
                    <option value="Espa√±ol">üá™üá∏ Espa√±ol</option>
                    <option value="Fran√ßais">üá´üá∑ Fran√ßais</option>
                    <option value="Italiano">üáÆüáπ Italiano</option>
                    <option value="Deutsch">üá©üá™ Deutsch</option>
                </select></div>

            <!-- BIBLIOTECA -->
            <div class="div"></div>
            <div class="lbl"><i>üìö</i>BIBLIOTECA</div>
            <div class="lib" id="lib">
                <div class="lib-empty">Nenhum e-book ainda</div>
            </div>

            <!-- STATS -->
            <div class="div"></div>
            <div class="lbl"><i>üìä</i>ESTAT√çSTICAS</div>
            <div class="sg">
                <div class="sc">
                    <div class="sc__n" id="stB">0</div>
                    <div class="sc__l">E-books</div>
                </div>
                <div class="sc">
                    <div class="sc__n" id="stC">0</div>
                    <div class="sc__l">Cap√≠tulos</div>
                </div>
                <div class="sc">
                    <div class="sc__n" id="stP">0</div>
                    <div class="sc__l">P√°ginas</div>
                </div>
                <div class="sc">
                    <div class="sc__n" id="stM">0</div>
                    <div class="sc__l">Mensagens</div>
                </div>
            </div>

            <div class="sb-ft">
                <div class="sb-fc">‚ö° <b>Gemini AI</b> ¬∑ üñºÔ∏è <b>Imagens IA</b> ¬∑ üìÑ <b>PDF Pro</b></div>
            </div>
        </div>
    </aside>

    <!-- MAIN -->
    <div class="main">
        <div class="top">
            <div class="top__st"><span class="top__dot"></span>Online</div>
            <div class="top__sep"></div>
            <span class="top__mdl">gemini-2.5-flash-lite ¬∑ img-gen</span>
            <div class="top__r">
                <button class="top__btn" onclick="clearChat()">üóëÔ∏è Limpar</button>
                <button class="top__btn" onclick="exportChat()">üì§ Exportar</button>
            </div>
        </div>

        <div class="chat" id="chat">
            <div class="welcome" id="welcome">
                <span class="welcome__ic">üìö</span>
                <h1 class="welcome__t">Ol√°! Sou o BookBot</h1>
                <p class="welcome__sub">Me conte sobre qual e-book deseja criar. Eu organizo tudo,
                    escrevo o conte√∫do com IA, gero imagens e entrego um PDF profissional!</p>
                <div class="welcome__feats">
                    <div class="welcome__f">ü§ñ IA Generativa</div>
                    <div class="welcome__f">üñºÔ∏è Imagens com IA</div>
                    <div class="welcome__f">‚úçÔ∏è Corre√ß√£o Ortogr√°fica</div>
                    <div class="welcome__f">üé® 6 Temas Premium</div>
                    <div class="welcome__f">üåç 6 Idiomas</div>
                    <div class="welcome__f">üëÅÔ∏è Preview do PDF</div>
                    <div class="welcome__f">üìö Biblioteca Local</div>
                </div>
            </div>
        </div>

        <div class="sugs" id="sugs">
            <button class="sug" onclick="sendSug(this)">üìò E-book sobre Intelig√™ncia Artificial</button>
            <button class="sug" onclick="sendSug(this)">üí∞ Guia de Investimentos</button>
            <button class="sug" onclick="sendSug(this)">üêç Python do Zero ao Avan√ßado</button>
            <button class="sug" onclick="sendSug(this)">üß† Produtividade e H√°bitos</button>
            <button class="sug" onclick="sendSug(this)">üèãÔ∏è Guia de Muscula√ß√£o e Nutri√ß√£o</button>
            <button class="sug" onclick="sendSug(this)">üì± Marketing Digital Avan√ßado</button>
            <button class="sug" onclick="sendSug(this)">üßò Mindfulness e Medita√ß√£o</button>
            <button class="sug" onclick="sendSug(this)">‚öñÔ∏è Direito Trabalhista para Leigos</button>
        </div>

        <div class="inp-area">
            <div class="inp-w">
                <input type="text" id="inp" placeholder="Descreva o e-book que deseja criar..."
                    onkeydown="if(event.key==='Enter')send()" autocomplete="off">
                <button class="snd" onclick="send()" id="sndBtn" title="Enviar">‚û§</button>
            </div>
        </div>
    </div>

    <script>
        // ====== PARTICLES ======
        const cv = document.getElementById('particles'), cx = cv.getContext('2d'); let pts = [];
        function initP() {
            cv.width = innerWidth; cv.height = innerHeight; pts = [];
            const n = Math.min(Math.floor(cv.width * cv.height / 20000), 80);
            for (let i = 0; i < n; i++)pts.push({
                x: Math.random() * cv.width, y: Math.random() * cv.height,
                vx: (Math.random() - .5) * .2, vy: (Math.random() - .5) * .2, s: Math.random() * 1.2 + .3, a: Math.random() * .2 + .05
            })
        }
        function drawP() {
            cx.clearRect(0, 0, cv.width, cv.height);
            pts.forEach(p => {
                p.x += p.vx; p.y += p.vy;
                if (p.x < 0) p.x = cv.width; if (p.x > cv.width) p.x = 0;
                if (p.y < 0) p.y = cv.height; if (p.y > cv.height) p.y = 0;
                cx.beginPath(); cx.arc(p.x, p.y, p.s, 0, Math.PI * 2);
                cx.fillStyle = `rgba(124,58,237,${p.a})`; cx.fill()
            });
            requestAnimationFrame(drawP)
        }
        addEventListener('resize', initP); initP(); drawP();

        // ====== STATE ======
        let hist = [], mc = 0, gen = false, lastPdfUrl = null, lastPdfTitle = '';
        // Quando estiver hospedado no GitHub Pages, altere esta vari√°vel para a URL do seu backend LocalTunnel ou Cloud API:
        // Exemplo: const API_BASE = 'https://sua-url-aqui.loca.lt';
        const API_BASE = 'https://wild-onions-burn.loca.lt';
        const S = { theme: 'Minimalista Moderno', style: 'Profissional', audience: 'P√∫blico geral', language: 'Portugu√™s Brasileiro' };
        let lib = JSON.parse(localStorage.getItem('bb_lib') || '[]');
        renderLib(); updStats();

        // ====== SIDEBAR ======
        function pk(el, k) {
            el.parentElement.querySelectorAll('.oc').forEach(c => c.classList.remove('on'));
            el.classList.add('on'); S[k] = el.dataset.val
        }

        function sendTpl(cat, prompt) {
            document.getElementById('inp').value = prompt;
            document.getElementById('sugs').style.display = 'none'; send()
        }

        // ====== LIBRARY ======
        function renderLib() {
            const el = document.getElementById('lib');
            if (!lib.length) { el.innerHTML = '<div class="lib-empty">Nenhum e-book ainda</div>'; return }
            el.innerHTML = lib.slice().reverse().map((b, i) => `
    <div class="lib-item" onclick="addMsg('b','üìö Para re-baixar \\'${b.title}\\', pe√ßa novamente no chat!')">
      <div class="lib-item__t">${b.title}</div>
      <div class="lib-item__m"><span>${b.ch}ch</span><span>${b.d}</span></div>
    </div>`).join('')
        }
        function addLib(title, ch, theme) {
            const d = new Date(); lib.push({ title, ch, theme, d: d.toLocaleDateString('pt-BR') });
            localStorage.setItem('bb_lib', JSON.stringify(lib)); renderLib(); updStats()
        }
        function updStats() {
            document.getElementById('stB').textContent = lib.length;
            document.getElementById('stC').textContent = lib.reduce((s, b) => s + b.ch, 0);
            document.getElementById('stP').textContent = lib.reduce((s, b) => s + b.ch * 5, 0);
            document.getElementById('stM').textContent = mc
        }

        // ====== PDF PREVIEW ======
        function openPdf(url, title) {
            lastPdfUrl = url; lastPdfTitle = title;
            document.getElementById('pdfTitle').textContent = title;
            document.getElementById('pdfFrame').src = url;
            document.getElementById('pdfDlBtn').href = url;
            document.getElementById('pdfDlBtn').download = title + '.pdf';
            document.getElementById('pdfModal').classList.add('show')
        }
        function closePdf() {
            document.getElementById('pdfModal').classList.remove('show');
            document.getElementById('pdfFrame').src = ''
        }
        document.getElementById('pdfModal').addEventListener('click', e => {
            if (e.target === e.currentTarget) closePdf()
        });
        document.addEventListener('keydown', e => { if (e.key === 'Escape') closePdf() });

        // ====== CHAT ======
        const chatEl = document.getElementById('chat'), inp = document.getElementById('inp');
        const sndBtn = document.getElementById('sndBtn'), sugsEl = document.getElementById('sugs');

        function addMsg(role, content, extra = '') {
            const w = document.getElementById('welcome'); if (w) w.style.display = 'none';
            const d = document.createElement('div'); d.className = `msg msg--${role}`;
            const av = role === 'b' ? 'üìö' : 'üë§';
            let html = content.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\*(.*?)\*/g, '<em>$1</em>').replace(/`(.*?)`/g, '<code>$1</code>')
                .replace(/\n/g, '<br>');
            d.innerHTML = `<div class="msg__a">${av}</div><div><div class="msg__bb">${html}</div>${extra ? '<div class="msg__ex">' + extra + '</div>' : ''}</div>`;
            chatEl.appendChild(d); chatEl.scrollTop = chatEl.scrollHeight; mc++; updStats(); return d
        }

        function showTyp() {
            const d = document.createElement('div'); d.className = 'msg msg--b'; d.id = 'typI';
            d.innerHTML = `<div class="msg__a">üìö</div><div class="msg__bb"><div class="typ"><i></i><i></i><i></i></div></div>`;
            chatEl.appendChild(d); chatEl.scrollTop = chatEl.scrollHeight
        }
        function hideTyp() { const e = document.getElementById('typI'); if (e) e.remove() }

        function sendSug(b) { inp.value = b.textContent.replace(/^[^\s]+\s/, ''); sugsEl.style.display = 'none'; send() }

        function clearChat() {
            hist = []; chatEl.innerHTML = ''; sugsEl.style.display = 'flex';
            const ww = document.createElement('div'); ww.className = 'welcome'; ww.id = 'welcome';
            ww.innerHTML = `<span class="welcome__ic">üìö</span><h1 class="welcome__t">BookBot</h1>
  <p class="welcome__sub">Me conte sobre o e-book que deseja criar!</p>`; chatEl.appendChild(ww)
        }

        function exportChat() {
            const txt = hist.map(m => `[${m.role}]: ${m.content}`).join('\n\n');
            const a = document.createElement('a'); a.href = URL.createObjectURL(new Blob([txt]));
            a.download = 'bookbot_chat.txt'; a.click()
        }

        async function send() {
            const text = inp.value.trim(); if (!text || gen) return; inp.value = '';
            sugsEl.style.display = 'none'; sndBtn.disabled = true;
            addMsg('u', text); hist.push({ role: 'user', content: text }); showTyp();
            try {
                const res = await fetch(`${API_BASE}/chat`, {
                    method: 'POST', headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        history: hist, message: text, theme: S.theme,
                        style: S.style, audience: S.audience, language: S.language
                    })
                });
                hideTyp();
                if (!res.ok) { const e = await res.json(); throw new Error(e.detail || `Erro ${res.status}`) }
                const data = await res.json();
                hist.push({ role: 'bot', content: data.response }); addMsg('b', data.response);
                if (data.ebook_data) await genEbook(data.ebook_data);
            } catch (e) { hideTyp(); addMsg('b', `‚ùå ${e.message}`) }
            sndBtn.disabled = false; inp.focus()
        }

        // ====== GENERATION ======
        async function genEbook(data) {
            gen = true; sndBtn.disabled = true; data.theme = S.theme;
            const tl = `<div class="tl" id="tl">
    <div class="tl-s on" id="g1"><span class="tl-i">‚è≥</span>Gerando conte√∫do com IA...</div>
    <div class="tl-s" id="g2"><span class="tl-i">‚¨ú</span>Criando imagens com IA...</div>
    <div class="tl-s" id="g3"><span class="tl-i">‚¨ú</span>Revisando ortografia...</div>
    <div class="tl-s" id="g4"><span class="tl-i">‚¨ú</span>Compilando PDF premium...</div></div>`;
            addMsg('b', 'üöÄ Gerando seu e-book com IA! Conte√∫do + imagens + design...', tl);
            const pi = setInterval(() => {
                const ss = ['g1', 'g2', 'g3', 'g4'], a = document.querySelector('.tl-s.on'); if (!a) return;
                const i = ss.indexOf(a.id);
                if (i < ss.length - 1 && Math.random() > .6) {
                    a.classList.replace('on', 'ok'); a.querySelector('.tl-i').textContent = '‚úÖ';
                    const n = document.getElementById(ss[i + 1]);
                    if (n) { n.classList.add('on'); n.querySelector('.tl-i').textContent = '‚è≥' }
                }
            }, 7000);
            try {
                const payload = {
                    title: data.title, author: data.author || 'Autor', theme: data.theme,
                    chapters: data.chapters.map(c => ({ title: c.title, pages: c.pages || 5 }))
                };
                const res = await fetch('/generate-from-form', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload)
                });
                clearInterval(pi);
                document.querySelectorAll('.tl-s').forEach(s => {
                    s.classList.remove('on'); s.classList.add('ok');
                    s.querySelector('.tl-i').textContent = '‚úÖ'
                });
                if (!res.ok) { const e = await res.json(); throw new Error(e.detail) }
                const blob = await res.blob(); const url = URL.createObjectURL(blob);
                addLib(data.title, data.chapters.length, data.theme);
                const dl = `<div class="dl"><div class="dl__t">‚ú® E-book pronto!</div>
      <div class="dl__s">"${data.title}" ‚Äî ${data.chapters.length} cap√≠tulos ¬∑ Imagens IA ¬∑ ${S.theme}</div>
      <a class="dl__b" href="${url}" download="${data.title}.pdf">üì• Baixar PDF</a>
      <button class="dl__b dl__b--preview" onclick="openPdf('${url}','${data.title.replace(/'/g, "\\'")}')">üëÅÔ∏è Preview</button>
    </div>`;
                addMsg('b', 'üéâ Seu e-book foi gerado com sucesso!', dl);
                addMsg('b', 'üí° **Dica:** Clique em **Preview** para folhear o PDF, ou **Baixar** para salvar. Quer criar outro? √â s√≥ pedir!');
            } catch (e) { clearInterval(pi); addMsg('b', `‚ùå Erro: ${e.message}`) }
            gen = false; sndBtn.disabled = false; inp.focus()
        }

        inp.focus();
    </script>
</body>

</html>